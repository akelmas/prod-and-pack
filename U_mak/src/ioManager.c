/*
 * ioManager.c
 *
 *  Created on: Sep 18, 2021
 *      Author: elmas
 */
#include <unistd.h>
#include <stdlib.h>
#include <math.h>

#include "ioManager.h"


/******************************************************************************/
static int outIndex=0;
static unsigned char incomingProductQuality[]={
		89,88,89,90,86,89,88,91,84,84,86,89,85,88,87,88,84,85,85,82,78,82,82,84
		,86,89,91,81,85,88,88,84,87,83,87,89,87,80,85,87,85,88,74,90,85,80,87,83
		,78,89,86,85,88,89,86,78,82,79,88,85,85,81,89,84,85,96,81,89,86,85,85,87
		,85,92,85,83,80,82,79,78,90,94,83,84,91,82,85,83,81,89,90,87,86,88,90,87
		,88,80,88,87,86,88,85,82,83,81,84,82,89,86,89,77,85,85,87,86,89,78,83,85
		,86,85,87,87,78,92,80,87,90,89,84,85,89,80,82,90,86,82,90,83,83,81,82,84
		,83,81,86,74,85,87,84,79,76,85,80,87,89,89,82,83,80,88,86,81,85,90,81,79
		,82,80,89,84,83,82,84,86,85,90,88,78,81,90,78,84,78,83,85,91,79,92,88,79
		,82,90,84,88,88,85,87,84,83,86,85,86,78,87,83,91,84,88,82,86,84,84,85,86
		,91,90,87,87,86,87,87,84,86,80,82,78,88,82,88,85,85,80,90,79,81,93,83,83
		,91,85,90,84,83,82,85,86,85,89,84,86,88,87,83,88,80,86,87,84,87,86,88,82
		,93,84,88,88,80,81,92,80,79,80,86,80,83,79,87,91,85,88,81,85,91,78,77,85
		,86,87,83,93,83,82,86,83,86,88,81,87,80,90,87,82,83,88,87,84,94,92,87,85
		,83,86,87,83,87,87,83,85,83,87,87,89,77,86,87,86,79,83,83,89,83,89,88,88
		,91,87,86,83,87,80,86,86,87,94,86,91,82,84,83,86,83,85,89,86,84,89,80,88
		,82,83,85,88,88,89,87,86,78,90,83,82,88,94,81,86,87,86,82,85,85,85,93,86
		,83,85,87,85,89,81,81,83,85,87,86,83,84,80,83,82,87,82,90,81,86,84,83,83
		,83,74,84,84,87,83,88,89,90,82,84,84,85,84,87,85,85,85,88,84,88,93,88,79
		,86,83,88,84,86,88,87,87,87,81,87,82,85,88,79,83,89,83,85,86,88,92,83,83
		,85,80,84,86,84,87,82,80,83,86,79,88,92,87,83,78,85,80,89,79,85,90,83,92
		,87,86,78,85,89,81,87,92,84,83,82,80,84,85,83,83,88,83,84,87,83,91,81,79
		,89,83,84,82,83,87,91,86,79,88,79,81,87,87,87,86,82,85,87,86,86,86,81,88
		,83,85,82,84,94,87,82,88,87,92,81,84,89,86,84,84,88,86,81,85,88,82,83,79
		,87,87,82,89,87,91,88,86,84,85,89,84,88,87,82,76,83,84,85,80,86,88,85,84
		,80,83,89,85,87,81,81,85,86,81,75,92,79,89,89,92,84,86,82,87,91,82,87,87
		,86,80,88,79,88,90,87,83,83,85,90,86,80,79,87,93,81,83,86,85,79,89,83,91
		,91,82,86,85,88,84,84,86,83,91,82,90,81,84,87,86,85,84,87,83,85,81,83,84
		,87,83,86,80,83,84,84,75,75,85,85,83,90,82,84,85,85,84,86,76,84,87,87,82
		,81,86,89,82,81,88,86,84,82,82,87,86,91,87,82,81,76,83,86,81,85,89,86,88
		,84,92,88,86,83,79,81,81,84,88,83,88,82,80,84,91,89,86,82,82,84,91,90,82
		,79,84,88,85,79,86,84,87,89,88,87,86,84,86,86,86,89,82,89,87,90,89,86,84
		,87,86,83,77,79,78,84,91,88,84,87,83,89,83,79,82,87,86,88,89,83,81,89,85
		,83,87,83,88,90,91,84,86,83,81,77,85,81,83,89,83,86,83,84,82,84,89,79,80
		,83,92,83,78,82,86,83,89,85,81,93,89,82,93,87,89,91,89,84,83,87,89,81,85
		,88,90,80,80,82,89,86,73,85,81,91,85,86,89,89,85,82,88,90,82,84,90,79,83
		,84,86,86,84,85,89,88,81,86,84,86,83,88,87,84,84,87,81,85,83,90,85,80,89
		,82,85,86,84,83,82,86,90,86,84,85,83,84,90,87,85,82,82,90,85,81,95,91,84
		,94,85,88,81,81,83,85,87,88,89,81,89,92,87,90,87,83,83,83,85,86,88,82,87
		,89,88,86,81,80,83,85,83,86,82,82,90,85,85,87,83,84,88,85,85,94,86,90,79
		,84,77,87,84,89,90,83,88,82,76,89,87,83,86,90,90,85,87,80,94,83,83,81,82
		,86,85,83,88,84,89,89,81,79,81,86,88,87,86,84,85,82,84,85,85,92,85,86,85
		,88,79,86,88,83,84,81,82,83,81,79,85,84,81,85,82
};

static unsigned char outcomingProdQuality[]=
{
		89,95,93,97,93,96,97,93,94,93,92,91,92,90,96,95,93,95,92,92,93,89,94,93
		,95,93,93,93,88,90,93,92,96,90,96,96,94,94,93,93,96,91,96,92,91,96,91,96
		,92,92,92,91,89,94,94,92,95,92,92,91,94,95,93,91,95,93,94,94,92,90,91,90
		,91,89,91,95,91,92,95,94,91,91,95,94,90,96,96,93,94,91,94,92,91,93,94,91
		,95,95,98,92,95,93,98,94,96,95,96,92,91,95,92,93,95,92,90,94,93,94,90,96
		,93,91,93,95,90,92,93,96,96,97,93,92,92,94,93,92,96,87,97,95,94,93,90,93
		,96,91,95,95,92,97,89,93,94,95,93,90,91,92,96,88,93,91,92,91,92,96,94,94
		,92,94,95,94,94,94,89,93,91,91,96,90,97,92,92,91,91,92,92,92,89,97,94,91
		,93,93,96,88,92,92,94,91,94,91,94,95,96,91,93,95,94,95,88,93,92,95,92,93
		,89,90,90,95,91,91,92,89,92,93,91,89,96,98,95,95,87,96,93,95,93,94,98,95
		,88,95,91,94,93,87,93,94,92,91,96,87,92,91,97,93,95,91,97,85,92,95,93,91
		,92,96,96,95,92,91,92,91,95,97,96,92,88,94,94,93,92,95,88,87,98,92,91,97
		,93,89,93,97,92,96,94,92,88,94,92,95,92,93,97,90,95,95,96,93,92,87,92,91
		,96,90,94,91,94,94,96,96,97,93,84,92,88,93,92,93,93,97,91,92,95,91,90,92
		,90,96,89,88,91,90,93,94,94,96,91,89,95,89,95,96,91,92,95,89,91,95,90,89
		,92,94,94,91,93,90,96,91,90,90,94,95,96,90,92,91,91,96,94,92,96,91,93,95
		,90,95,86,97,95,95,94,96,97,92,95,90,95,96,91,96,93,93,92,95,93,95,92,93
		,95,91,95,97,96,90,93,90,96,94,95,94,92,97,98,88,94,90,96,92,89,94,96,94
		,91,99,91,92,94,89,98,94,91,95,89,94,94,90,97,94,92,93,91,95,94,94,95,91
		,89,89,93,92,91,92,90,93,96,93,92,96,95,93,94,88,87,93,94,96,93,90,98,95
		,92,94,92,96,93,95,93,92,91,93,91,93,92,96,96,94,94,97,93,93,93,94,93,95
		,95,98,91,95,90,96,95,97,93,94,90,93,92,94,95,94,87,94,94,93,94,98,94,93
		,93,92,92,95,92,96,93,89,91,93,96,96,87,98,89,89,92,96,93,93,97,92,93,95
		,90,92,94,95,94,93,95,90,94,95,89,94,93,89,91,95,95,91,93,92,94,95,94,94
		,94,87,89,96,91,90,94,91,91,91,93,88,95,89,95,94,92,91,91,94,90,96,89,90
		,96,95,94,93,93,97,94,92,96,89,93,89,88,90,95,97,96,91,95,95,87,92,97,93
		,91,93,92,91,98,97,90,90,96,91,92,95,91,91,97,94,90,93,96,93,93,95,95,93
		,87,88,96,91,97,95,91,92,93,95,95,94,96,92,93,90,95,94,97,95,94,92,92,91
		,91,92,97,96,94,96,92,92,90,92,98,98,93,89,90,93,95,93,96,94,90,92,94,90
		,92,97,90,89,93,94,91,97,97,94,93,94,94,93,94,94,93,96,94,96,95,94,92,97
		,92,90,92,94,95,90,96,95,90,91,95,96,91,94,93,92,94,92,92,91,95,93,94,95
		,90,96,94,90,93,92,92,94,91,87,92,96,92,93,92,92,93,95,94,95,91,91,89,94
		,96,88,93,89,90,97,90,95,95,86,97,97,93,94,90,93,93,89,92,93,93,92,93,94
		,93,95,94,95,95,90,94,93,93,91,90,91,95,92,91,96,91,86,94,95,88,93,92,92
		,95,91,92,96,92,97,92,89,92,92,97,92,94,83,93,94,97,96,92,94,93,95,93,96
		,91,96,97,90,92,96,86,88,95,95,90,94,92,95,92,94,92,92,96,95,94,96,88,91
		,97,94,95,94,96,97,94,96,92,93,91,89,93,92,97,94,94,91,92,89,93,91,90,95
		,91,91,90,86,92,95,93,94,90,88,91,97,89,96,94,92,91,94,85,91,93,95,93,92
		,93,89,94,92,93,93,92,90,94,96,93,94,91,91,87,94,89,91,96,95,91,96,95,92
		,93,99,90,94,91,94,91,95,88,90,93,92,95,93,92,90,96,93,87,94,89,91,94,91
		,94,89,89,93,96,89,91,95,96,96,90,93,92,95,91,92,91,93,93,92,94,94,95,97
		,98,89,93,93,89,89,97,91,93,90,92,96,89,96,96,93
};

/******************************************************************************/

int ioReadPrepSensor(void)
{
	float quality;
	int index;

	quality = rand()/RAND_MAX;
	index = 999*quality;

	if(incomingProductQuality[index]>0.8)
		return SUCCESS;

	return ERROR;
}
int ioProcessProduct(Product product)
{
	sleep(3);
	return SUCCESS;
}
int ioReadQualitySensor(int* quality)
{
	*quality=outcomingProdQuality[outIndex++];

	if(outIndex==1000)
	{
		outIndex=0;
	}
	return SUCCESS;
}
